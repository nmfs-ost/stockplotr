<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>How captions and alternative text are generated • stockplotr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="How captions and alternative text are generated">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stockplotr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>

  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="far fa-file-code fa-lg"></span>

    Functions
  </a>
</li>
<li>
  <a href="../stockplotr_cheatsheet.pdf">
    <span class="fa fa-solid fa-key"></span>

    Cheatsheet
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fas fa-file-contract fa-lg"></span>

    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/manual.html">Manual</a>
    </li>
    <li>
      <a href="../articles/how-caps-alttext-are-made.html">How captions and alternative text are generated</a>
    </li>
    <li>
      <a href="../articles/convert_output_details.html">Standardizing Assessment Model Output</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nmfs-ost/stockplotr/issues" class="external-link">
    <span class="fas fa-question-circle fa-lg"></span>

    Issues
  </a>
</li>
<li>
  <a href="https://github.com/nmfs-ost/stockplotr/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>How captions and alternative text are
generated</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nmfs-ost/stockplotr/blob/main/vignettes/how-caps-alttext-are-made.Rmd" class="external-link"><code>vignettes/how-caps-alttext-are-made.Rmd</code></a></small>
      <div class="hidden name"><code>how-caps-alttext-are-made.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="how-captions-and-alternative-text-are-generated">How captions and alternative text are generated<a class="anchor" aria-label="anchor" href="#how-captions-and-alternative-text-are-generated"></a>
</h2>
<p>If you create tables and/or figures with this package, you will
notice that captions and alternative text will be automatically
generated. This vignette explains how these texts are created.</p>
<div class="section level3">
<h3 id="templates">Templates<a class="anchor" aria-label="anchor" href="#templates"></a>
</h3>
<p>The <a href="https://github.com/nmfs-ost/stockplotr/blob/main/inst/resources/captions_alt_text_template.csv" class="external-link">‘captions_alt_text_template.csv’
file</a> contains the templates for each table or figure’s
caption/alternative text. Tables have captions, and figures have
captions and alternative text. Please refer to <a href="https://nmfs-ost.github.io/asar/articles/accessibility_guide.html" class="external-link">the
<code>asar</code> package’s accessibility vignette</a> to learn more
about how we aimed to construct clear and comprehensive alternative
text.</p>
<p>As <em>templates</em>, these texts are the <em>starting point</em>
for the final captions and alternative text (again, we encourage users
to read the <a href="https://nmfs-ost.github.io/asar/articles/accessibility_guide.html" class="external-link">the
<code>asar</code> package’s accessibility vignette</a> to learn how and
why they should check the accuracy and write the final component of each
figure’s alternative text). Specifically, there are placeholders
throughout the texts (e.g., B.ref.pt, B.min, B.max). If the model
results are parsed successfully, these placeholders will eventually be
replaced with key quantities from the model results. For example,
B.ref.pt will be replaced with the biomass figure’s reference point, and
B.min and B.max will be replaced with the minimum and maximum
biomass.</p>
<p>The file is set up like this:</p>
<ul>
<li>Column 1 (“label”) is a shorthand label for your figure or table.
Labels are somewhat short and exclude spaces. Examples include “kobe”,
“relative.biomass”, and “fishing.mortality”.</li>
<li>Column 2 (“type”) contains “figure” or “table”.</li>
<li>Column 3 (“caption”) contains the caption.</li>
<li>Column 4 (“alt_text”) contains alternative text for figures. For
tables, this column is blank.</li>
</ul>
<table style="width:98%;" class="table">
<caption>Format for csv containing table and figure captions and
alternative text.</caption>
<colgroup>
<col width="14%">
<col width="13%">
<col width="30%">
<col width="39%">
</colgroup>
<thead><tr class="header">
<th colspan="4">label | type | caption | alt_text |</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>example_fig</td>
<td colspan="3">figure | Example caption for figure. | Example
alternative text for figure. |</td>
</tr>
<tr class="even">
<td>example_tab</td>
<td colspan="3">table | Example caption for table. | |</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="workflow-in-four-key-steps">Workflow in four key steps<a class="anchor" aria-label="anchor" href="#workflow-in-four-key-steps"></a>
</h3>
<p>Next, key quantities are extracted from the model results (which have
already been converted into a standardized format using
<code><a href="https://noaa-fisheries-integrated-toolbox.r-universe.dev/asar/reference/convert_output.html" class="external-link">asar::convert_output()</a></code>). Finally, key quantities replace
the placeholders in the captions/alt text template.</p>
<p>These steps are performed by four key functions within
<code><a href="../reference/create_rda.html">create_rda()</a></code>, which is housed within
<code>utils_rda.R</code>. These functions are:</p>
<ol style="list-style-type: decimal">
<li><code><a href="../reference/write_captions.html">write_captions()</a></code></li>
<li><code>add_more_key_quants()</code></li>
<li><code><a href="../reference/extract_caps_alttext.html">extract_caps_alttext()</a></code></li>
<li><code>export_rda</code></li>
</ol>
<p>The steps are discussed, below.</p>
<p><strong>NOTE</strong>: While we extract key quantities as accurately
as we can, we cannot guarantee that each quantity will be calculated
perfectly. Input data varies widely. It’s always your responsibility to
check the accuracy of your figures’ alt text.</p>
</div>
<div class="section level3">
<h3 id="extracting-key-quantities-from-model-results">Extracting key quantities from model results<a class="anchor" aria-label="anchor" href="#extracting-key-quantities-from-model-results"></a>
</h3>
<div class="section level4">
<h4 id="write_captions">
<code>write_captions()</code><a class="anchor" aria-label="anchor" href="#write_captions"></a>
</h4>
<p>In this function, the captions_alt_text_template.csv file is imported
as a dataframe. Then, key quantities are extracted from the model
results and substituted into the dataframe’s appropriate placeholders.
Finally, the function exports the updated dataframe as a new csv
(“captions_alt_text.csv”).</p>
</div>
<div class="section level4">
<h4 id="add_more_key_quants">
<code>add_more_key_quants()</code><a class="anchor" aria-label="anchor" href="#add_more_key_quants"></a>
</h4>
<p>This function imports the new captions_alt_text.csv as a dataframe.
Then, it substitutes some placeholders with key quantities that cannot
be extracted from the model results because they are manually specified
by the user, or are derived using such quantities (e.g., a figure’s end
year, units, reference point, and more). The function exports the
dataframe by overwriting the csv with the same filename.</p>
</div>
</div>
<div class="section level3">
<h3 id="connecting-the-tables-figures-with-the-captions-alternative-text">Connecting the tables &amp; figures with the captions &amp;
alternative text<a class="anchor" aria-label="anchor" href="#connecting-the-tables-figures-with-the-captions-alternative-text"></a>
</h3>
<div class="section level4">
<h4 id="extract_caps_alttext">
<code>extract_caps_alttext()</code><a class="anchor" aria-label="anchor" href="#extract_caps_alttext"></a>
</h4>
<p>This function selects the appropriate captions and alternative text
from captions_alt_text.csv when a figure or table.</p>
</div>
<div class="section level4">
<h4 id="export_rda">
<code>export_rda</code><a class="anchor" aria-label="anchor" href="#export_rda"></a>
</h4>
<p>Finally, this function exports an rda containing 1) a table and
caption, or 2) a figure, caption, and alternative text.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="expected-outcomes">Expected outcomes<a class="anchor" aria-label="anchor" href="#expected-outcomes"></a>
</h2>
<div class="section level3">
<h3 id="single-plot-functions">Single plot functions<a class="anchor" aria-label="anchor" href="#single-plot-functions"></a>
</h3>
<p>When using functions that produce one table or figure at a time, like
<code><a href="../reference/plot_biomass.html">plot_biomass()</a></code>, only certain key quantities will be
substituted into the placeholders. For instance,</p>
<ul>
<li>
<code><a href="../reference/write_captions.html">write_captions()</a></code> will substitute as many key quantities
as possible, regardless of whether those quantities are associated with
biomass.</li>
<li>
<code>add_more_key_quants()</code> will only substitute additional
key quantities that are associated with biomass because only those
quantities will be specified by the user. For example, if a user
specifies the unit label argument in the <code><a href="../reference/plot_biomass.html">plot_biomass()</a></code> as
“metric tons”, then <code>add_more_key_quants()</code> will replace the
placeholder associated with biomass units (B.units will changed to
metric tons). However, no other placeholder associated with landings
units, recruitment deviations units, etc. will be substituted, and those
placeholders will remain in the captions_alt_text.csv file.</li>
</ul>
</div>
<div class="section level3">
<h3 id="multi-plot-functions">Multi-plot functions<a class="anchor" aria-label="anchor" href="#multi-plot-functions"></a>
</h3>
<p>When using <code><a href="../reference/save_all_plots.html">save_all_plots()</a></code>, the <code>stockplotr</code>
function that exports all figures and tables, all key quantities (or, as
many key quantities as possible) will be substituted into the
placeholders. As opposed to single-plot functions,
<code><a href="../reference/save_all_plots.html">save_all_plots()</a></code> allows for the user to specify all
arguments needed to substitute all key quantities.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Samantha Schiano, Sophie Breitbart, Steve Saul.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
